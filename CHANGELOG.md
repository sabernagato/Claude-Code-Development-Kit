# 更新日志

所有 Claude Code 开发套件的重要更改都将记录在此文件中。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
本项目遵循 [语义化版本](https://semver.org/lang/zh-CN/spec/v2.0.0.html)。


## [2.1.0] - 2025-07-11

### 新增
- 新的 `/gemini-consult` 命令，用于与 Gemini MCP 进行深入的迭代对话
  - 支持复杂问题解决的持久会话
  - 未提供参数时的上下文感知问题检测
  - 自动附加项目文档和 MCP-ASSISTANT-RULES.md
  - 支持会话连续性的后续问题
- `/update-docs` 命令中的核心文档原则部分
  - 强调仅记录当前的"是"状态
  - 提供要避免的反模式和要遵循的最佳实践
  - 确保文档读起来就像当前实现一直存在一样

### 改进
- 增强的设置脚本，带条件命令安装
  - 仅在选择 Gemini MCP 时安装 `/gemini-consult` 命令
  - 基于所选组件的相关命令，提供更好的用户体验
- 更新的命令 README，包含全面的 `/gemini-consult` 文档
  - 添加了用例和工作流示例
  - 集成到典型的开发模式中

### v2.0.0 新特性：
- **安全性**：自动扫描防止意外暴露 API 密钥和秘密
- **上下文增强**：项目结构和 MCP 助手规则自动包含在 Gemini 咨询中
- **子代理上下文**：所有子代理现在自动接收核心项目文档
- **开发者体验**：任务完成和输入请求的音频通知
- **MCP 助手规则**：为 MCP 助手定义项目特定的编码标准
- **无破坏性更改**：所有 v1.0.0 功能保持不变且完全兼容


## [2.0.0] - 2025-07-10

### 新增
- 作为第 4 个核心框架组件的综合钩子系统
  - 安全扫描器钩子，防止在使用 MCP 服务器时意外暴露秘密
  - Gemini 上下文注入器，用于在咨询中自动包含项目结构和 MCP 助手规则
  - 子代理上下文注入器，用于在所有子代理任务中自动包含文档
  - 带音频反馈的跨平台通知系统
- MCP-ASSISTANT-RULES.md 支持项目特定的编码标准
  - `docs/MCP-ASSISTANT-RULES.md` 中的自定义模板
  - 通过更新的钩子自动注入到 Gemini 咨询中
  - 框架根目录中的示例实现（已添加到 gitignore）
- 钩子设置命令（`/hook-setup`）用于简化配置验证
- Claude Code 配置的设置模板，预配置了所有钩子
- 钩子配置示例和全面的文档
- `docs/CLAUDE.md` 中的多代理工作流文档部分
- `commands/README.md` 中的自动上下文注入文档
- 通过 curl 命令的远程安装功能
  - 新的 `install.sh` 脚本用于一键安装
  - 从 GitHub 下载框架而无需克隆
  - 带进度指示器的专业安装程序
  - 自动清理临时文件
- 用于框架安装的交互式 `setup.sh` 脚本
  - 先决条件检查，对所需工具有清晰的解释
  - 可选组件的交互式提示和描述
  - 基于用户选择的条件文件复制
  - 现有文件的冲突解决（跳过/覆盖/全部）
  - 仅在选择通知时进行动态操作系统检测
  - 仅使用选定组件生成配置文件
  - 跨平台支持（macOS、Linux、通过 WSL 的 Windows）


### 改进
- 通过自动子代理上下文注入改善开发者体验
- 所有命令中更一致的多代理工作流模式
- 通过移除手动上下文加载简化子代理提示
- 两种安装方法改善安装体验：快速安装（curl）或手动（git clone）
- 更清晰的安装说明和正确的 MCP 服务器链接改进文档
- 通过逐步设置指导和组件描述改善用户引导
- 通过文件冲突解决而非自动覆盖提高设置安全性

### 变更
- 第 2 层和第 3 层文档文件从 CLAUDE.md 重命名为 CONTEXT.md
- 更新所有文档和模板以反映新的命名约定
- 明确只有第 1 层（主上下文）保留为 CLAUDE.md


## [1.0.0] - 2025-07-01

### 新增
- 包含 3 个核心组件的初始框架发布
- 三层文档系统（基础/组件/功能）
- 多代理工作流的命令模板
  - `/full-context` - 全面的上下文收集和分析
  - `/code-review` - 多视角代码分析
  - `/update-docs` - 文档同步
  - `/create-docs` - 初始文档生成
  - `/refactor` - 智能代码重构
  - `/handoff` - 会话上下文保存
- MCP 服务器集成模式（Context7、Gemini）
- 关键文档的自动加载机制
- 带路由系统的全面文档结构
- 问题和规范的示例模板
- 外部 AI 服务的集成指南

### 核心功能
- 通过文档层次结构自动管理上下文
- 复杂任务的子代理编排
- 与外部 AI 专家系统的无缝集成
- 自我维护的文档系统


## 从 v1.0.0 升级到 v2.0.0

钩子系统是可选的，但建议使用以增强安全性和开发者体验。

### 将钩子添加到现有的 v1.0.0 项目：

1. **将钩子目录复制到您的项目**：
   ```bash
   cp -r hooks your-project/.claude/hooks/
   ```

2. **在您的项目中配置钩子**：
   ```bash
   # 将设置模板复制到您的项目
   cp hooks/setup/settings.json.template your-project/.claude/settings.json
   
   # 编辑以更新 WORKSPACE 路径
   # 包括 subagent-context-injector 在内的所有钩子都已预配置
   ```

3. **测试安装**：
   ```bash
   # 运行钩子设置验证
   /hook-setup
   ```

4. **更新现有命令文件**（可选）：
   - 命令无需更改即可工作，但您可以简化子代理提示
   - 从 Task 提示中删除手动的 `Read /CLAUDE.md` 指令
   - 子代理现在自动接收核心文档